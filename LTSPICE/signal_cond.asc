Version 4
SHEET 1 3368 1708
WIRE 1008 -144 832 -144
WIRE 1680 -144 1088 -144
WIRE -272 -112 -496 -112
WIRE -112 -112 -272 -112
WIRE 48 -112 -32 -112
WIRE 208 -112 48 -112
WIRE 432 -112 288 -112
WIRE -496 -96 -496 -112
WIRE 1200 -64 1120 -64
WIRE 1680 -64 1680 -144
WIRE 1680 -64 1264 -64
WIRE 224 0 176 0
WIRE 1456 0 1408 0
WIRE -496 32 -496 -16
WIRE -496 32 -592 32
WIRE 224 48 224 0
WIRE -112 64 -160 64
WIRE 48 64 48 -112
WIRE 48 64 -32 64
WIRE 192 64 48 64
WIRE 1456 64 1456 0
WIRE -496 80 -496 32
WIRE 432 80 432 -112
WIRE 432 80 256 80
WIRE 528 80 432 80
WIRE 672 80 528 80
WIRE 832 80 832 -144
WIRE 832 80 752 80
WIRE 896 80 832 80
WIRE 1120 80 1120 -64
WIRE 1120 80 976 80
WIRE 1424 80 1120 80
WIRE 192 96 48 96
WIRE 1680 96 1680 -64
WIRE 1680 96 1488 96
WIRE 1792 96 1680 96
WIRE 1952 96 1792 96
WIRE 1424 112 1264 112
WIRE 48 160 48 96
WIRE 1792 160 1792 96
WIRE 1952 160 1952 96
WIRE 224 176 224 112
WIRE 224 176 176 176
WIRE 832 176 832 80
WIRE 1456 176 1456 128
WIRE 1456 176 1408 176
WIRE 1264 192 1264 112
WIRE -496 208 -496 160
WIRE 1792 256 1792 224
WIRE 1952 256 1952 224
WIRE 1952 256 1792 256
WIRE 1952 272 1952 256
WIRE 832 304 832 240
WIRE -64 352 -192 352
WIRE -64 384 -64 352
WIRE -64 496 -64 464
WIRE -64 496 -224 496
WIRE -224 512 -224 496
WIRE -64 544 -64 496
WIRE -64 656 -64 624
WIRE -64 656 -176 656
WIRE 1008 896 832 896
WIRE 1680 896 1088 896
WIRE -272 928 -496 928
WIRE -112 928 -272 928
WIRE 48 928 -32 928
WIRE 208 928 48 928
WIRE 432 928 288 928
WIRE -496 960 -496 928
WIRE 1200 976 1120 976
WIRE 1680 976 1680 896
WIRE 1680 976 1264 976
WIRE 224 1040 176 1040
WIRE 1456 1040 1408 1040
WIRE -496 1072 -496 1040
WIRE -496 1072 -608 1072
WIRE 224 1088 224 1040
WIRE 48 1104 48 928
WIRE 192 1104 48 1104
WIRE 1456 1104 1456 1040
WIRE -496 1120 -496 1072
WIRE 432 1120 432 928
WIRE 432 1120 256 1120
WIRE 528 1120 432 1120
WIRE 672 1120 528 1120
WIRE 832 1120 832 896
WIRE 832 1120 752 1120
WIRE 896 1120 832 1120
WIRE 1120 1120 1120 976
WIRE 1120 1120 976 1120
WIRE 1424 1120 1120 1120
WIRE 192 1136 48 1136
WIRE 1680 1136 1680 976
WIRE 1680 1136 1488 1136
WIRE 1824 1136 1680 1136
WIRE 2016 1136 1824 1136
WIRE 1424 1152 1264 1152
WIRE 1824 1184 1824 1136
WIRE 2016 1184 2016 1136
WIRE 48 1200 48 1136
WIRE 224 1216 224 1152
WIRE 224 1216 176 1216
WIRE 832 1216 832 1120
WIRE 1456 1216 1456 1168
WIRE 1456 1216 1408 1216
WIRE 1264 1232 1264 1152
WIRE -496 1248 -496 1200
WIRE 1824 1280 1824 1248
WIRE 2016 1280 2016 1248
WIRE 2016 1280 1824 1280
WIRE 2016 1296 2016 1280
WIRE 832 1344 832 1280
FLAG -496 208 0
FLAG 48 160 0
FLAG 528 80 out_sig_current
FLAG 176 0 +VCC
FLAG 176 176 -VCC
FLAG -272 -112 in_current_noise
FLAG 1408 176 -VCC
FLAG 1408 0 +VCC
FLAG -224 512 0
FLAG -192 352 +VCC
FLAG -176 656 -VCC
FLAG 832 304 0
FLAG 1680 96 out_filt_current
FLAG 1264 192 0
FLAG -160 64 +VCC
FLAG -496 1248 0
FLAG 48 1200 0
FLAG 528 1120 out_sig_voltage
FLAG 176 1040 +VCC
FLAG 176 1216 -VCC
FLAG -272 928 in_voltage_noise
FLAG 1408 1216 -VCC
FLAG 1408 1040 +VCC
FLAG 832 1344 0
FLAG 1680 1136 out_filt_voltage
FLAG 1264 1232 0
FLAG 1952 272 0
FLAG 2016 1296 0
FLAG -608 1072 in_voltage
FLAG -592 32 in_current
SYMBOL res -128 -96 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value {Rin_i}
SYMBOL res -128 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value {Roffset_i}
SYMBOL res 192 -96 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value {Rsum}
SYMBOL Misc\\signal -496 64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value SINE(0 7.5 100 0 0 -90)
SYMBOL OpAmps\\ADTL082 224 16 R0
SYMATTR InstName U1
SYMBOL OpAmps\\ADTL082 1456 32 R0
SYMATTR InstName U2
SYMBOL voltage -64 368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 15V
SYMBOL voltage -64 528 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 15V
SYMBOL res 992 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {Rf3}
SYMBOL cap 816 176 R0
SYMATTR InstName C2
SYMATTR Value {Cf2}
SYMBOL cap 1264 -80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {Cf1}
SYMBOL res 1104 -160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {Rf2}
SYMBOL bv -496 -112 R0
SYMATTR InstName B1
SYMATTR Value V=white(5e5*time)*0.75
SYMBOL res -128 944 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value {Rin_v}
SYMBOL res 192 944 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R9
SYMATTR Value {Rsum}
SYMBOL Misc\\signal -496 1104 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(3.75 3.75 100 0 0 -90)
SYMBOL OpAmps\\ADTL082 224 1056 R0
SYMATTR InstName U3
SYMBOL bv -496 944 R0
SYMATTR InstName B2
SYMATTR Value V=white(5e5*time)*0.75
SYMBOL res 768 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {Rf1}
SYMBOL OpAmps\\ADTL082 1456 1072 R0
SYMATTR InstName U4
SYMBOL res 992 1104 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {Rf3}
SYMBOL cap 816 1216 R0
SYMATTR InstName C3
SYMATTR Value {Cf2}
SYMBOL cap 1264 960 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value {Cf1}
SYMBOL res 1104 880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value {Rf2}
SYMBOL res 768 1104 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value {Rf1}
SYMBOL schottky 1968 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value 1N5817
SYMBOL schottky 2032 1248 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value 1N5817
SYMBOL zener 1840 1248 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value 1N4619
SYMBOL zener 1808 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N4619
TEXT -768 440 Left 2 ;we need a couple of voltage sources\nbc we need + and - 15V
TEXT 392 120 Left 2 ;out_sig should be: 0 ~ 3V
TEXT -776 520 Left 2 !.tran 0 20m 0 1u
TEXT -728 112 Left 2 ;current sensor\n-7.5V ~ +7.5V
TEXT -88 -440 Left 2 ;Vout_i = -(Vin_i*(Rsum/Rin_i) + Voffset*(Rsum/Roffset))\nVin_i = current sensor signal\nVoffset = +15V (offset)\nRsum/Rin_i = 1.5/7.5 = 0.2\nRsum/Roffset = 1.5/15 = 0.1
TEXT -208 176 Left 2 ;voltage offset\nget from VCC = +15V
TEXT -728 1152 Left 2 ;voltage sensor\n0V ~ +7.5V
TEXT 152 696 Left 2 ;Vout_v = -Vin_v*(Rsum/Rin_v)\nVin_v = voltage sensor signal\nRsum/Rin_v = 3/7.5 = 0.4
TEXT -720 840 Left 2 ;noises, assume:\n10% max signal\n@ 10x filter cutoff freq
TEXT 832 -232 Left 2 !.param Rf1=6.8K Rf2=6.8K Rf3=4.3K Cf1=10nF Cf2=47nF
TEXT 840 -272 Left 2 ;butterworth 2nd order multiple feedback filter (fc=1kHz)
TEXT -88 -272 Left 2 !.param Roffset_i=68K Rin_i=34K Rsum=6.8K
TEXT 144 800 Left 2 !.param Rin_v=17K
TEXT 840 768 Left 2 ;butterworth 2nd order multiple feedback filter (fc=1kHz)
TEXT -672 -216 Left 2 ;noises, assume:\n10% max signal\n@ 10x filter cutoff freq
TEXT 384 1160 Left 2 ;out_sig should be: 0 ~ 3V
TEXT -776 576 Left 2 ;.four 50Hz 10000 V(in_current)\n.four 50Hz 10000 V(out_filt_current)\n.four 50Hz 10000 V(out_sig_current)\n.four 50Hz 10000 V(in_voltage)\n.four 50Hz 10000 V(out_filt_voltage)\n.four 50Hz 10000 V(out_sig_voltage)
TEXT 208 240 Left 2 !* ZENER DIODE (1N4619)\n.MODEL 1N4619 D\n+ IS=5.5571E-15\n+ N=1.0682\n+ RS=.39434\n+ IKF=5.6772\n+ CJO=124.99E-12\n+ M=.31419\n+ VJ=.50488\n+ ISR=18.959E-6\n+ NR=4.9950\n+ BV=3.1436\n+ IBV=64.676E-3\n+ TT=216.40E-9
TEXT 1752 24 Left 2 ;protection circuit\nclamp between 0 to 3V
TEXT 1824 1064 Left 2 ;protection circuit\nclamp between 0 to 3V

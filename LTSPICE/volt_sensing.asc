Version 4
SHEET 1 2424 1444
WIRE 192 48 0 48
WIRE 416 48 272 48
WIRE 480 48 416 48
WIRE 672 48 560 48
WIRE 784 48 672 48
WIRE 896 48 864 48
WIRE 1072 48 896 48
WIRE 1232 48 1136 48
WIRE 0 64 0 48
WIRE 544 128 512 128
WIRE 1056 128 1024 128
WIRE 0 176 0 144
WIRE 544 176 544 128
WIRE 1056 176 1056 128
WIRE 416 192 416 48
WIRE 512 192 416 192
WIRE 896 192 896 48
WIRE 1024 192 896 192
WIRE 672 208 672 48
WIRE 672 208 576 208
WIRE 1232 208 1232 48
WIRE 1232 208 1088 208
WIRE 192 224 0 224
WIRE 352 224 272 224
WIRE 512 224 352 224
WIRE 1024 224 896 224
WIRE 0 240 0 224
WIRE 352 240 352 224
WIRE 544 272 544 240
WIRE 544 272 512 272
WIRE 1056 272 1056 240
WIRE 1056 272 1024 272
WIRE 896 336 896 224
WIRE 0 352 0 320
WIRE 352 352 352 320
WIRE 80 432 -48 432
WIRE 192 432 80 432
WIRE 368 432 272 432
WIRE 80 464 80 432
WIRE 368 464 368 432
WIRE 80 576 80 544
WIRE 80 576 -80 576
WIRE 368 576 368 528
WIRE -80 592 -80 576
WIRE 80 624 80 576
WIRE 832 720 672 720
WIRE 1008 720 832 720
WIRE 80 736 80 704
WIRE 80 736 -32 736
WIRE 1872 736 1712 736
WIRE 2048 736 1872 736
WIRE 672 784 672 720
WIRE 1712 784 1712 736
WIRE 1872 784 1872 736
WIRE 1008 896 1008 720
WIRE 1872 896 1872 864
WIRE 2048 912 2048 736
WIRE 672 944 672 864
WIRE 944 944 672 944
WIRE 1712 960 1712 864
WIRE 1872 960 1712 960
WIRE 1984 960 1872 960
WIRE 672 992 672 944
WIRE 1712 1008 1712 960
WIRE -544 1024 -672 1024
WIRE -320 1024 -464 1024
WIRE -256 1024 -320 1024
WIRE -64 1024 -176 1024
WIRE 2048 1024 2048 1008
WIRE -672 1040 -672 1024
WIRE 464 1040 336 1040
WIRE 608 1040 544 1040
WIRE 1008 1040 1008 992
WIRE 336 1056 336 1040
WIRE 1472 1056 1376 1056
WIRE 1584 1056 1584 928
WIRE 1584 1056 1552 1056
WIRE 1648 1056 1584 1056
WIRE 1376 1072 1376 1056
WIRE -192 1104 -224 1104
WIRE 672 1136 672 1088
WIRE 1008 1136 1008 1104
WIRE 2048 1136 2048 1104
WIRE 2048 1136 1984 1136
WIRE -192 1152 -192 1104
WIRE 2048 1152 2048 1136
WIRE -672 1168 -672 1120
WIRE -320 1168 -320 1024
WIRE -224 1168 -320 1168
WIRE -64 1184 -64 1024
WIRE -64 1184 -160 1184
WIRE 336 1184 336 1136
WIRE -224 1200 -400 1200
WIRE 1376 1200 1376 1152
WIRE -192 1248 -192 1216
WIRE -192 1248 -224 1248
WIRE 672 1248 672 1200
WIRE 1008 1248 1008 1216
WIRE -400 1264 -400 1200
WIRE 1712 1264 1712 1104
WIRE 2048 1264 2048 1216
WIRE 2048 1392 2048 1344
FLAG -80 592 0
FLAG -48 432 +VCC
FLAG -32 736 -VCC
FLAG 512 128 +VCC
FLAG 512 272 -VCC
FLAG 352 352 0
FLAG 0 352 0
FLAG 0 176 0
FLAG 368 576 0
FLAG 368 432 4V7
FLAG 1024 128 +VCC
FLAG 1024 272 -VCC
FLAG 896 336 0
FLAG 832 720 +VCC
FLAG 1008 1248 0
FLAG 672 1248 0
FLAG -224 1104 +VCC
FLAG -224 1248 -VCC
FLAG -672 1168 0
FLAG -400 1264 0
FLAG 336 1184 0
FLAG 2048 1392 0
FLAG 1712 1264 0
FLAG 1376 1200 0
FLAG 1872 896 0
FLAG 1872 960 fault
FLAG 1984 1136 Vdf
FLAG 1584 928 gsc_fault
SYMBOL OpAmps\\ADTL082 544 144 R0
SYMATTR InstName U2
SYMBOL voltage 80 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 15V
SYMBOL voltage 80 608 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 15V
SYMBOL res 336 224 R0
SYMATTR InstName R1
SYMATTR Value {Rg}
SYMBOL res 288 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {R2}
SYMBOL res 288 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {R1}
SYMBOL res 576 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {Rf}
SYMBOL zener 384 528 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value D1N4732
SYMBOL voltage 0 48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vin
SYMATTR Value 0.27
SYMBOL voltage 0 224 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vref
SYMATTR Value 4.7V
SYMBOL res 288 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 2k
SYMBOL res 768 32 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL OpAmps\\ADTL082 1056 144 R0
SYMATTR InstName U1
SYMBOL LED 1136 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 72 32 VTop 2
SYMATTR InstName D4
SYMBOL npn 608 992 R0
SYMATTR InstName Q1
SYMBOL pnp 944 992 M180
SYMATTR InstName Q2
SYMBOL res 656 768 R0
SYMATTR InstName R5
SYMATTR Value 9.1k
SYMBOL LED 992 1040 R0
SYMATTR InstName D1
SYMBOL res 992 1120 R0
SYMATTR InstName R8
SYMATTR Value 500
SYMBOL res 560 1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL zener 688 1200 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value D1N4732
SYMBOL OpAmps\\ADTL082 -192 1120 R0
SYMATTR InstName U3
SYMBOL res -448 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL res -160 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 19.6k
SYMBOL voltage -672 1024 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(0 0.48 0 20m 0 0)
SYMBOL voltage 336 1040 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 10 0 20m 0 0)
SYMBOL npn 1648 1008 R0
SYMATTR InstName Q3
SYMBOL pnp 1984 1008 M180
SYMATTR InstName Q4
SYMBOL res 2032 1008 R0
SYMATTR InstName R11
SYMATTR Value 47
SYMBOL voltage 1872 768 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 3.3V
SYMBOL res 1696 768 R0
SYMATTR InstName R15
SYMATTR Value 9k1
SYMBOL LED 2032 1152 R0
SYMATTR InstName D5
SYMBOL voltage 1376 1056 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value PULSE(0 5V 5m 0 0 15m)
SYMBOL res 1568 1040 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 100
SYMBOL voltage 2048 1248 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value PULSE(0 1.3V 5m 0 0 15m)
TEXT 24 -304 Left 2 ;Vout =  Vref*((Rf+R1)*Rg)/((Rg+R2)*R1) - Vin*(Rf/R1)\nVin = 0.24V (more than 24 VDC)\nVref = +15V (offset)\nRf/R1 = 4.7/0.24 = 19.6\n((Rf+R1)*Rg)/((Rg+R2)*R1) = 4.7/4.7 = 1
TEXT 864 -168 Left 2 !.model D1N4732  D(Is=1.064f Rs=.741 Ikf=0 N=1 Xti=3 Eg=1.11 Cjo=208p M=.4176\n+               Vj=.75 Fc=.5 Isr=2.364n Nr=2 Bv=4.7 Ibv=.16902 Nbv=1.2344\n+               Ibvl=4.0082m Nbvl=11.59 Tbv1=-21.28u)
TEXT 176 -96 Left 2 !.param R1=1k Rf=19.6k R2=19.6k Rg=1k
TEXT 176 -56 Left 2 !.tran 0 20m 0 1u
